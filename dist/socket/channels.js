"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var authentication_channel_1 = require("./authentication.channel");
function singletonDispatch(handler, msg, client, strut) {
    return handler(msg, strut)
        .then(function (r) {
        client.emit(msg.responseKey, r);
    });
}
function dispatch(s) {
    s.io.on('connection', function (client) {
        client.on('auth', function (msg) {
            singletonDispatch(authentication_channel_1.dispatch, msg, client, s);
        });
    });
}
exports.dispatch = dispatch;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zb2NrZXQvY2hhbm5lbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFHQSxtRUFBbUU7QUFFbkUsMkJBQTJCLE9BQXVCLEVBQUUsR0FBc0MsRUFBRSxNQUF1QixFQUFFLEtBQWtCO0lBQ3JJLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQztTQUN6QixJQUFJLENBQUMsVUFBQyxDQUFDO1FBQ04sTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2xDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVELGtCQUF5QixDQUFjO0lBQ3JDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxVQUFDLE1BQU07UUFDM0IsTUFBTSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsVUFBQyxHQUFHO1lBQ3BCLGlCQUFpQixDQUFDLGlDQUFXLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQU5ELDRCQU1DIiwiZmlsZSI6InNvY2tldC9jaGFubmVscy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFNvY2tldElPIGZyb20gJ3NvY2tldC5pbyc7XG5pbXBvcnQgeyBTdHJ1dFNlcnZlciB9IGZyb20gJy4uL2luZGV4JztcbmltcG9ydCB7IFNpbmdsZXRvblJlcXVlc3QsIFJlcXVlc3RIYW5kbGVyLCBDaGFubmVsUmVxdWVzdCB9IGZyb20gJy4vbWVzc2FnZUludGVyZmFjZXMnO1xuaW1wb3J0IHsgZGlzcGF0Y2ggYXMgYXV0aENoYW5uZWwgfSBmcm9tICcuL2F1dGhlbnRpY2F0aW9uLmNoYW5uZWwnO1xuXG5mdW5jdGlvbiBzaW5nbGV0b25EaXNwYXRjaChoYW5kbGVyOiBSZXF1ZXN0SGFuZGxlciwgbXNnOiBTaW5nbGV0b25SZXF1ZXN0ICYgQ2hhbm5lbFJlcXVlc3QsIGNsaWVudDogU29ja2V0SU8uQ2xpZW50LCBzdHJ1dDogU3RydXRTZXJ2ZXIpIHtcbiAgcmV0dXJuIGhhbmRsZXIobXNnLCBzdHJ1dClcbiAgLnRoZW4oKHIpID0+IHtcbiAgICBjbGllbnQuZW1pdChtc2cucmVzcG9uc2VLZXksIHIpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3BhdGNoKHM6IFN0cnV0U2VydmVyKSB7XG4gIHMuaW8ub24oJ2Nvbm5lY3Rpb24nLCAoY2xpZW50KSA9PiB7XG4gICAgY2xpZW50Lm9uKCdhdXRoJywgKG1zZykgPT4ge1xuICAgICAgc2luZ2xldG9uRGlzcGF0Y2goYXV0aENoYW5uZWwsIG1zZywgY2xpZW50LCBzKTtcbiAgICB9KTtcbiAgfSk7XG59XG4iXX0=
