"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var authentication_channel_1 = require("./authentication.channel");
function singletonDispatch(handler, msg, strut) {
    return handler(msg, strut).then(function (r) {
        msg.client.emit(msg.responseKey, r);
    });
}
function dispatch(s) {
    s.services.io.on('connection', function (client) {
        client.on('auth', function (msg) {
            var request = Object.assign({}, msg, { client: client });
            singletonDispatch(authentication_channel_1.dispatch, request, s);
        });
    });
}
exports.dispatch = dispatch;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zb2NrZXQvY2hhbm5lbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFPQSxtRUFBbUU7QUFFbkUsMkJBQ0UsT0FBdUIsRUFDdkIsR0FBc0MsRUFDdEMsS0FBa0I7SUFFbEIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsQ0FBQztRQUMvQixHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3RDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVELGtCQUF5QixDQUFjO0lBQ3JDLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsVUFBQSxNQUFNO1FBQ25DLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLFVBQUEsR0FBRztZQUNuQixJQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztZQUMzRCxpQkFBaUIsQ0FBQyxpQ0FBVyxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQVBELDRCQU9DIiwiZmlsZSI6InNvY2tldC9jaGFubmVscy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFNvY2tldElPIGZyb20gJ3NvY2tldC5pbyc7XG5pbXBvcnQgeyBTdHJ1dFNlcnZlciB9IGZyb20gJy4uL2luZGV4JztcbmltcG9ydCB7XG4gIFNpbmdsZXRvblJlcXVlc3QsXG4gIFJlcXVlc3RIYW5kbGVyLFxuICBDaGFubmVsUmVxdWVzdCxcbn0gZnJvbSAnLi9tZXNzYWdlSW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBkaXNwYXRjaCBhcyBhdXRoQ2hhbm5lbCB9IGZyb20gJy4vYXV0aGVudGljYXRpb24uY2hhbm5lbCc7XG5cbmZ1bmN0aW9uIHNpbmdsZXRvbkRpc3BhdGNoKFxuICBoYW5kbGVyOiBSZXF1ZXN0SGFuZGxlcixcbiAgbXNnOiBTaW5nbGV0b25SZXF1ZXN0ICYgQ2hhbm5lbFJlcXVlc3QsXG4gIHN0cnV0OiBTdHJ1dFNlcnZlcixcbikge1xuICByZXR1cm4gaGFuZGxlcihtc2csIHN0cnV0KS50aGVuKHIgPT4ge1xuICAgIG1zZy5jbGllbnQuZW1pdChtc2cucmVzcG9uc2VLZXksIHIpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3BhdGNoKHM6IFN0cnV0U2VydmVyKSB7XG4gIHMuc2VydmljZXMuaW8ub24oJ2Nvbm5lY3Rpb24nLCBjbGllbnQgPT4ge1xuICAgIGNsaWVudC5vbignYXV0aCcsIG1zZyA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gT2JqZWN0LmFzc2lnbih7fSwgbXNnLCB7IGNsaWVudDogY2xpZW50IH0pO1xuICAgICAgc2luZ2xldG9uRGlzcGF0Y2goYXV0aENoYW5uZWwsIHJlcXVlc3QsIHMpO1xuICAgIH0pO1xuICB9KTtcbn1cbiJdfQ==
